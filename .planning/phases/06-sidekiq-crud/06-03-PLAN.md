---
phase: 06-sidekiq-crud
plan: 03
type: execute
wave: 2
depends_on: ["06-01", "06-02"]
files_modified:
  - sidekiq-webapp/src/app/(dashboard)/sidekiqs/page.tsx
  - sidekiq-webapp/src/app/(dashboard)/sidekiqs/layout.tsx
  - sidekiq-webapp/src/components/sidekiq/sidekiq-list.tsx
  - sidekiq-webapp/src/components/sidekiq/sidekiq-card.tsx
  - sidekiq-webapp/src/components/sidekiq/sidekiq-empty-state.tsx
  - sidekiq-webapp/src/components/sidebar/sidebar-sidekiqs.tsx
  - sidekiq-webapp/src/components/sidebar/sidebar-collapsed.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate to /sidekiqs and see their Sidekiq list"
    - "Empty state shows Create your first Sidekiq CTA when no Sidekiqs exist"
    - "User can toggle between grid and list view"
    - "Sidebar shows recent and favorited Sidekiqs with See all link"
    - "View preference persists across page refreshes"
  artifacts:
    - path: "sidekiq-webapp/src/app/(dashboard)/sidekiqs/page.tsx"
      provides: "Sidekiqs list page"
      min_lines: 30
    - path: "sidekiq-webapp/src/components/sidekiq/sidekiq-list.tsx"
      provides: "Grid/list view container with view toggle"
      exports: ["SidekiqList"]
    - path: "sidekiq-webapp/src/components/sidekiq/sidekiq-empty-state.tsx"
      provides: "Empty state with CTA"
      exports: ["SidekiqEmptyState"]
    - path: "sidekiq-webapp/src/components/sidebar/sidebar-sidekiqs.tsx"
      provides: "Sidebar section for Sidekiqs"
      exports: ["SidebarSidekiqs"]
  key_links:
    - from: "sidekiq-webapp/src/components/sidekiq/sidekiq-list.tsx"
      to: "sidekiq-webapp/src/hooks/use-view-preference.ts"
      via: "view preference hook"
      pattern: "useViewPreference"
    - from: "sidekiq-webapp/src/app/(dashboard)/sidekiqs/page.tsx"
      to: "api.sidekiq.list"
      via: "tRPC query"
      pattern: "api\\.sidekiq\\.list"
---

<objective>
Create the Sidekiqs list page with grid/list view toggle and sidebar integration.

Purpose: Provides the main entry point for users to view and manage their Sidekiqs, with empty state to guide first-time users.
Output: /sidekiqs page with hybrid view, sidebar section showing recent/favorites, empty state CTA.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-sidekiq-crud/06-CONTEXT.md
@.planning/phases/06-sidekiq-crud/06-RESEARCH.md
@.planning/phases/06-sidekiq-crud/06-01-SUMMARY.md
@.planning/phases/06-sidekiq-crud/06-02-SUMMARY.md

# Existing patterns
@sidekiq-webapp/src/components/chat/empty-state.tsx
@sidekiq-webapp/src/components/sidebar/sidebar.tsx
@sidekiq-webapp/src/components/sidebar/sidebar-collapsed.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Sidekiq list components</name>
  <files>
sidekiq-webapp/src/components/sidekiq/sidekiq-list.tsx
sidekiq-webapp/src/components/sidekiq/sidekiq-card.tsx
sidekiq-webapp/src/components/sidekiq/sidekiq-empty-state.tsx
sidekiq-webapp/src/components/sidekiq/sidekiq-avatar.tsx
  </files>
  <action>
Create the list view components:

**1. Create `src/components/sidekiq/sidekiq-avatar.tsx`:**

```typescript
import { Avatar, AvatarFallback } from "@sidekiq/components/ui/avatar";
import { cn } from "@sidekiq/lib/utils";
import { getInitials } from "@sidekiq/lib/utils/avatar";

interface SidekiqAvatarProps {
  name: string;
  avatar: {
    type: "initials" | "emoji";
    color: string;
    emoji?: string;
  };
  size?: "sm" | "md" | "lg";
  className?: string;
}

const sizeClasses = {
  sm: "size-8 text-xs",
  md: "size-10 text-sm",
  lg: "size-12 text-base",
};

/**
 * Avatar component for Sidekiq display.
 * Shows either initials or emoji on a colored background.
 */
export function SidekiqAvatar({
  name,
  avatar,
  size = "md",
  className,
}: SidekiqAvatarProps) {
  const initials = getInitials(name);

  return (
    <Avatar className={cn(sizeClasses[size], className)}>
      <AvatarFallback
        style={{ backgroundColor: avatar.color }}
        className="font-semibold text-white"
      >
        {avatar.type === "emoji" && avatar.emoji ? avatar.emoji : initials}
      </AvatarFallback>
    </Avatar>
  );
}
```

**2. Create `src/components/sidekiq/sidekiq-card.tsx`:**

```typescript
"use client";

import { formatDistanceToNow } from "date-fns";
import { MoreHorizontal, Star, MessageSquare } from "lucide-react";
import Link from "next/link";

import { Button } from "@sidekiq/components/ui/button";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@sidekiq/components/ui/dropdown-menu";
import { cn } from "@sidekiq/lib/utils";
import { SidekiqAvatar } from "./sidekiq-avatar";

interface SidekiqCardProps {
  sidekiq: {
    id: string;
    name: string;
    description: string | null;
    avatar: { type: "initials" | "emoji"; color: string; emoji?: string };
    isFavorite: boolean;
    lastUsedAt: Date | null;
    threadCount: number;
  };
  viewMode: "grid" | "list";
  onToggleFavorite: (id: string) => void;
  onDuplicate: (id: string) => void;
  onDelete: (id: string, name: string) => void;
}

/**
 * Card component for displaying a Sidekiq in grid or list view.
 * Shows avatar, name, description, usage stats, and quick actions.
 */
export function SidekiqCard({
  sidekiq,
  viewMode,
  onToggleFavorite,
  onDuplicate,
  onDelete,
}: SidekiqCardProps) {
  const lastUsedText = sidekiq.lastUsedAt
    ? `Used ${formatDistanceToNow(sidekiq.lastUsedAt, { addSuffix: true })}`
    : "Never used";

  const statsText = `${sidekiq.threadCount} chat${sidekiq.threadCount !== 1 ? "s" : ""}`;

  if (viewMode === "list") {
    return (
      <div className="hover:bg-accent/50 group flex items-center gap-4 rounded-lg border p-3 transition-colors">
        <SidekiqAvatar name={sidekiq.name} avatar={sidekiq.avatar} size="md" />
        <div className="min-w-0 flex-1">
          <div className="flex items-center gap-2">
            <Link
              href={`/sidekiqs/${sidekiq.id}/edit`}
              className="font-medium hover:underline"
            >
              {sidekiq.name}
            </Link>
            {sidekiq.isFavorite && (
              <Star className="size-3.5 fill-amber-400 text-amber-400" />
            )}
          </div>
          <p className="text-muted-foreground truncate text-sm">
            {sidekiq.description || "No description"}
          </p>
        </div>
        <div className="text-muted-foreground hidden text-sm md:block">
          {statsText}
        </div>
        <div className="text-muted-foreground hidden text-sm md:block">
          {lastUsedText}
        </div>
        <SidekiqCardActions
          sidekiq={sidekiq}
          onToggleFavorite={onToggleFavorite}
          onDuplicate={onDuplicate}
          onDelete={onDelete}
        />
      </div>
    );
  }

  // Grid view
  return (
    <div className="bg-card hover:bg-accent/30 group relative flex flex-col rounded-xl border p-4 transition-colors">
      <div className="mb-3 flex items-start justify-between">
        <SidekiqAvatar name={sidekiq.name} avatar={sidekiq.avatar} size="lg" />
        <SidekiqCardActions
          sidekiq={sidekiq}
          onToggleFavorite={onToggleFavorite}
          onDuplicate={onDuplicate}
          onDelete={onDelete}
        />
      </div>
      <Link href={`/sidekiqs/${sidekiq.id}/edit`} className="group/link">
        <h3 className="mb-1 flex items-center gap-2 font-semibold group-hover/link:underline">
          {sidekiq.name}
          {sidekiq.isFavorite && (
            <Star className="size-3.5 fill-amber-400 text-amber-400" />
          )}
        </h3>
      </Link>
      <p className="text-muted-foreground mb-3 line-clamp-2 flex-1 text-sm">
        {sidekiq.description || "No description"}
      </p>
      <div className="text-muted-foreground flex items-center gap-3 text-xs">
        <span className="flex items-center gap-1">
          <MessageSquare className="size-3" />
          {statsText}
        </span>
        <span>{lastUsedText}</span>
      </div>
    </div>
  );
}

function SidekiqCardActions({
  sidekiq,
  onToggleFavorite,
  onDuplicate,
  onDelete,
}: Pick<
  SidekiqCardProps,
  "sidekiq" | "onToggleFavorite" | "onDuplicate" | "onDelete"
>) {
  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button
          variant="ghost"
          size="icon-sm"
          className="opacity-0 group-hover:opacity-100"
        >
          <MoreHorizontal className="size-4" />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem asChild>
          <Link href={`/chat?sidekiq=${sidekiq.id}`}>Start chat</Link>
        </DropdownMenuItem>
        <DropdownMenuItem asChild>
          <Link href={`/sidekiqs/${sidekiq.id}/edit`}>Edit</Link>
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => onToggleFavorite(sidekiq.id)}>
          {sidekiq.isFavorite ? "Remove from favorites" : "Add to favorites"}
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => onDuplicate(sidekiq.id)}>
          Duplicate
        </DropdownMenuItem>
        <DropdownMenuSeparator />
        <DropdownMenuItem
          className="text-destructive focus:text-destructive"
          onClick={() => onDelete(sidekiq.id, sidekiq.name)}
        >
          Delete
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
```

**3. Create `src/components/sidekiq/sidekiq-empty-state.tsx`:**

```typescript
import Link from "next/link";
import { Sparkles, Plus } from "lucide-react";

import { Button } from "@sidekiq/components/ui/button";

/**
 * Empty state for Sidekiq list.
 * Shows when user has no Sidekiqs with CTA to create first one.
 */
export function SidekiqEmptyState() {
  return (
    <div className="flex flex-col items-center justify-center py-16 text-center">
      <div className="bg-primary/10 mb-4 rounded-full p-4">
        <Sparkles className="text-primary size-8" />
      </div>
      <h2 className="mb-2 text-xl font-semibold">Create your first Sidekiq</h2>
      <p className="text-muted-foreground mb-6 max-w-md">
        Sidekiqs are custom AI assistants with their own personality,
        instructions, and conversation starters. Create one to get started.
      </p>
      <Button asChild>
        <Link href="/sidekiqs/new">
          <Plus className="mr-2 size-4" />
          Create Sidekiq
        </Link>
      </Button>
    </div>
  );
}
```

**4. Create `src/components/sidekiq/sidekiq-list.tsx`:**

```typescript
"use client";

import { useState } from "react";
import { Grid3X3, List, Plus, Search } from "lucide-react";
import Link from "next/link";
import Fuse from "fuse.js";

import { Button } from "@sidekiq/components/ui/button";
import { Input } from "@sidekiq/components/ui/input";
import {
  ToggleGroup,
  ToggleGroupItem,
} from "@sidekiq/components/ui/toggle-group";
import { cn } from "@sidekiq/lib/utils";
import { useViewPreference } from "@sidekiq/hooks/use-view-preference";
import { useSidekiqActions } from "@sidekiq/hooks/use-sidekiq-actions";
import { api } from "@sidekiq/trpc/react";

import { SidekiqCard } from "./sidekiq-card";
import { SidekiqEmptyState } from "./sidekiq-empty-state";

interface SidekiqListProps {
  onOpenDeleteDialog: (id: string, name: string, threadCount: number) => void;
}

/**
 * Main list view for Sidekiqs with grid/list toggle and search.
 */
export function SidekiqList({ onOpenDeleteDialog }: SidekiqListProps) {
  const { viewMode, setViewMode, isHydrated } = useViewPreference();
  const [searchQuery, setSearchQuery] = useState("");
  const { toggleFavorite, duplicateSidekiq } = useSidekiqActions();

  const { data: sidekiqs, isLoading } = api.sidekiq.list.useQuery();

  // Filter by search
  const filteredSidekiqs = (() => {
    if (!sidekiqs) return [];
    if (!searchQuery.trim()) return sidekiqs;

    const fuse = new Fuse(sidekiqs, {
      keys: ["name", "description"],
      threshold: 0.4,
    });
    return fuse.search(searchQuery).map((r) => r.item);
  })();

  if (isLoading) {
    return (
      <div className="space-y-4">
        <div className="flex items-center justify-between">
          <div className="bg-muted h-10 w-64 animate-pulse rounded-md" />
          <div className="bg-muted h-10 w-32 animate-pulse rounded-md" />
        </div>
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {[1, 2, 3].map((i) => (
            <div key={i} className="bg-muted h-40 animate-pulse rounded-xl" />
          ))}
        </div>
      </div>
    );
  }

  if (!sidekiqs?.length) {
    return <SidekiqEmptyState />;
  }

  return (
    <div className="space-y-4">
      {/* Header with search and view toggle */}
      <div className="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
        <div className="relative max-w-sm flex-1">
          <Search className="text-muted-foreground absolute left-3 top-1/2 size-4 -translate-y-1/2" />
          <Input
            type="search"
            placeholder="Search Sidekiqs..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="pl-9"
          />
        </div>
        <div className="flex items-center gap-2">
          {isHydrated && (
            <ToggleGroup
              type="single"
              value={viewMode}
              onValueChange={(v) => v && setViewMode(v as "grid" | "list")}
            >
              <ToggleGroupItem value="grid" aria-label="Grid view">
                <Grid3X3 className="size-4" />
              </ToggleGroupItem>
              <ToggleGroupItem value="list" aria-label="List view">
                <List className="size-4" />
              </ToggleGroupItem>
            </ToggleGroup>
          )}
          <Button asChild>
            <Link href="/sidekiqs/new">
              <Plus className="mr-2 size-4" />
              New Sidekiq
            </Link>
          </Button>
        </div>
      </div>

      {/* Results */}
      {filteredSidekiqs.length === 0 ? (
        <div className="text-muted-foreground py-12 text-center">
          No Sidekiqs match your search
        </div>
      ) : (
        <div
          className={cn(
            viewMode === "grid"
              ? "grid gap-4 md:grid-cols-2 lg:grid-cols-3"
              : "space-y-2"
          )}
        >
          {filteredSidekiqs.map((sidekiq) => (
            <SidekiqCard
              key={sidekiq.id}
              sidekiq={sidekiq}
              viewMode={viewMode}
              onToggleFavorite={toggleFavorite}
              onDuplicate={duplicateSidekiq}
              onDelete={(id, name) =>
                onOpenDeleteDialog(id, name, sidekiq.threadCount)
              }
            />
          ))}
        </div>
      )}
    </div>
  );
}
```
  </action>
  <verify>
```bash
cd sidekiq-webapp && pnpm tsc --noEmit
```
Components should compile without errors.
  </verify>
  <done>
SidekiqList component with grid/list view toggle, search filtering, and loading states. SidekiqCard with hover actions. SidekiqEmptyState with CTA. SidekiqAvatar for consistent avatar display.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Sidekiqs page and layout</name>
  <files>
sidekiq-webapp/src/app/(dashboard)/sidekiqs/page.tsx
sidekiq-webapp/src/app/(dashboard)/sidekiqs/layout.tsx
sidekiq-webapp/src/components/sidekiq/delete-sidekiq-dialog.tsx
  </files>
  <action>
Create the page routes:

**1. Create `src/app/(dashboard)/sidekiqs/layout.tsx`:**

```typescript
import type { Metadata } from "next";

export const metadata: Metadata = {
  title: "Sidekiqs | Sidekiq",
  description: "Manage your custom AI assistants",
};

export default function SidekiqsLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return <>{children}</>;
}
```

**2. Create `src/components/sidekiq/delete-sidekiq-dialog.tsx`:**

```typescript
"use client";

import { useState } from "react";

import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@sidekiq/components/ui/alert-dialog";
import { Input } from "@sidekiq/components/ui/input";
import { Label } from "@sidekiq/components/ui/label";
import { Checkbox } from "@sidekiq/components/ui/checkbox";

interface DeleteSidekiqDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onConfirm: (deleteThreads: boolean) => void;
  sidekiqName: string;
  threadCount: number;
  isDeleting?: boolean;
}

/**
 * Type-to-confirm deletion dialog for Sidekiqs.
 * Per CONTEXT.md: user must type exact name to confirm.
 * Offers option to also delete associated conversations.
 */
export function DeleteSidekiqDialog({
  open,
  onOpenChange,
  onConfirm,
  sidekiqName,
  threadCount,
  isDeleting = false,
}: DeleteSidekiqDialogProps) {
  const [confirmText, setConfirmText] = useState("");
  const [deleteThreads, setDeleteThreads] = useState(false);

  const isConfirmed = confirmText === sidekiqName;

  const handleOpenChange = (open: boolean) => {
    if (!open) {
      setConfirmText("");
      setDeleteThreads(false);
    }
    onOpenChange(open);
  };

  return (
    <AlertDialog open={open} onOpenChange={handleOpenChange}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Delete &quot;{sidekiqName}&quot;?</AlertDialogTitle>
          <AlertDialogDescription>
            This action cannot be undone. Type the Sidekiq name to confirm.
          </AlertDialogDescription>
        </AlertDialogHeader>

        <div className="space-y-4 py-4">
          <div className="space-y-2">
            <Label htmlFor="confirm-name">
              Type{" "}
              <span className="font-mono font-semibold">{sidekiqName}</span> to
              confirm
            </Label>
            <Input
              id="confirm-name"
              value={confirmText}
              onChange={(e) => setConfirmText(e.target.value)}
              placeholder={sidekiqName}
              disabled={isDeleting}
              autoComplete="off"
            />
          </div>

          {threadCount > 0 && (
            <div className="flex items-start space-x-2">
              <Checkbox
                id="delete-threads"
                checked={deleteThreads}
                onCheckedChange={(checked) => setDeleteThreads(checked === true)}
                disabled={isDeleting}
              />
              <Label
                htmlFor="delete-threads"
                className="text-muted-foreground text-sm leading-relaxed"
              >
                Also delete {threadCount} conversation
                {threadCount > 1 ? "s" : ""} using this Sidekiq
              </Label>
            </div>
          )}
        </div>

        <AlertDialogFooter>
          <AlertDialogCancel disabled={isDeleting}>Cancel</AlertDialogCancel>
          <AlertDialogAction
            onClick={() => onConfirm(deleteThreads)}
            disabled={!isConfirmed || isDeleting}
            className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
          >
            {isDeleting ? "Deleting..." : "Delete Sidekiq"}
          </AlertDialogAction>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}
```

**3. Create `src/app/(dashboard)/sidekiqs/page.tsx`:**

```typescript
"use client";

import { useState } from "react";

import { SidekiqList } from "@sidekiq/components/sidekiq/sidekiq-list";
import { DeleteSidekiqDialog } from "@sidekiq/components/sidekiq/delete-sidekiq-dialog";
import { useSidekiqActions } from "@sidekiq/hooks/use-sidekiq-actions";

interface DeleteDialogState {
  open: boolean;
  id: string;
  name: string;
  threadCount: number;
}

/**
 * Sidekiqs list page.
 * Shows all user's Sidekiqs with grid/list view, search, and actions.
 */
export default function SidekiqsPage() {
  const { deleteSidekiq, isDeleting } = useSidekiqActions();
  const [deleteDialog, setDeleteDialog] = useState<DeleteDialogState>({
    open: false,
    id: "",
    name: "",
    threadCount: 0,
  });

  const handleOpenDeleteDialog = (
    id: string,
    name: string,
    threadCount: number
  ) => {
    setDeleteDialog({ open: true, id, name, threadCount });
  };

  const handleConfirmDelete = async (deleteThreads: boolean) => {
    await deleteSidekiq({ id: deleteDialog.id, deleteThreads });
    setDeleteDialog({ open: false, id: "", name: "", threadCount: 0 });
  };

  return (
    <div className="container max-w-6xl py-8">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">Sidekiqs</h1>
        <p className="text-muted-foreground mt-1">
          Create and manage your custom AI assistants
        </p>
      </div>

      <SidekiqList onOpenDeleteDialog={handleOpenDeleteDialog} />

      <DeleteSidekiqDialog
        open={deleteDialog.open}
        onOpenChange={(open) =>
          setDeleteDialog((prev) => ({ ...prev, open }))
        }
        onConfirm={handleConfirmDelete}
        sidekiqName={deleteDialog.name}
        threadCount={deleteDialog.threadCount}
        isDeleting={isDeleting}
      />
    </div>
  );
}
```

**4. Add Checkbox to shadcn/ui (if not exists):**

```bash
cd sidekiq-webapp && pnpm dlx shadcn@latest add checkbox -y
```
  </action>
  <verify>
1. Start dev server: `pnpm dev`
2. Navigate to /sidekiqs - should show empty state or list
3. Check TypeScript: `pnpm tsc --noEmit`
  </verify>
  <done>
/sidekiqs page created with SidekiqList, delete dialog, and proper layout with metadata. Empty state shows CTA when no Sidekiqs.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add Sidekiqs section to sidebar</name>
  <files>
sidekiq-webapp/src/components/sidebar/sidebar-sidekiqs.tsx
sidekiq-webapp/src/components/sidebar/sidebar.tsx
sidekiq-webapp/src/components/sidebar/sidebar-collapsed.tsx
  </files>
  <action>
Add Sidekiqs section to sidebar:

**1. Create `src/components/sidebar/sidebar-sidekiqs.tsx`:**

```typescript
"use client";

import Link from "next/link";
import { useRouter } from "next/navigation";
import { ChevronRight, Plus, Sparkles, Star } from "lucide-react";

import { Button } from "@sidekiq/components/ui/button";
import {
  Collapsible,
  CollapsibleContent,
  CollapsibleTrigger,
} from "@sidekiq/components/ui/collapsible";
import { cn } from "@sidekiq/lib/utils";
import { api } from "@sidekiq/trpc/react";
import { SidekiqAvatar } from "@sidekiq/components/sidekiq/sidekiq-avatar";

interface SidebarSidekiqsProps {
  onSidekiqSelect?: () => void;
}

/**
 * Sidebar section showing recent and favorited Sidekiqs.
 * Favorites appear first, then recent by lastUsedAt.
 * Shows max 5 items with "See all" link to /sidekiqs.
 */
export function SidebarSidekiqs({ onSidekiqSelect }: SidebarSidekiqsProps) {
  const router = useRouter();
  const { data: sidekiqs, isLoading } = api.sidekiq.list.useQuery(undefined, {
    // Only refetch on mount, not on every focus
    refetchOnWindowFocus: false,
  });

  // Show favorites first, then recent, max 5 total
  const displaySidekiqs = (() => {
    if (!sidekiqs) return [];
    const favorites = sidekiqs.filter((s) => s.isFavorite);
    const recent = sidekiqs.filter((s) => !s.isFavorite);
    return [...favorites, ...recent].slice(0, 5);
  })();

  const handleSidekiqClick = (id: string) => {
    // Navigate to start a chat with this Sidekiq (Phase 7)
    router.push(`/chat?sidekiq=${id}`);
    onSidekiqSelect?.();
  };

  return (
    <Collapsible defaultOpen className="px-2">
      <div className="flex items-center justify-between px-2 py-1">
        <CollapsibleTrigger className="group flex items-center gap-1 text-xs font-medium uppercase tracking-wider text-muted-foreground hover:text-foreground">
          <ChevronRight className="size-3 transition-transform group-data-[state=open]:rotate-90" />
          Sidekiqs
        </CollapsibleTrigger>
        <Button
          variant="ghost"
          size="icon-sm"
          asChild
          className="size-6"
        >
          <Link href="/sidekiqs/new">
            <Plus className="size-3.5" />
          </Link>
        </Button>
      </div>
      <CollapsibleContent>
        {isLoading ? (
          <div className="space-y-1 py-1">
            {[1, 2, 3].map((i) => (
              <div
                key={i}
                className="h-8 animate-pulse rounded-md bg-muted mx-2"
              />
            ))}
          </div>
        ) : displaySidekiqs.length === 0 ? (
          <div className="px-2 py-3 text-center">
            <p className="text-xs text-muted-foreground mb-2">
              No Sidekiqs yet
            </p>
            <Button variant="outline" size="sm" asChild className="w-full">
              <Link href="/sidekiqs/new">
                <Sparkles className="mr-2 size-3.5" />
                Create first
              </Link>
            </Button>
          </div>
        ) : (
          <div className="space-y-0.5 py-1">
            {displaySidekiqs.map((sidekiq) => (
              <button
                key={sidekiq.id}
                onClick={() => handleSidekiqClick(sidekiq.id)}
                className={cn(
                  "flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-left text-sm",
                  "hover:bg-accent/50 transition-colors"
                )}
              >
                <SidekiqAvatar
                  name={sidekiq.name}
                  avatar={sidekiq.avatar}
                  size="sm"
                  className="size-6"
                />
                <span className="flex-1 truncate">{sidekiq.name}</span>
                {sidekiq.isFavorite && (
                  <Star className="size-3 fill-amber-400 text-amber-400 shrink-0" />
                )}
              </button>
            ))}
            {sidekiqs && sidekiqs.length > 5 && (
              <Link
                href="/sidekiqs"
                className="block px-2 py-1.5 text-xs text-muted-foreground hover:text-foreground hover:underline"
              >
                See all {sidekiqs.length} Sidekiqs
              </Link>
            )}
          </div>
        )}
      </CollapsibleContent>
    </Collapsible>
  );
}
```

**2. Add Collapsible component (if not exists):**

```bash
cd sidekiq-webapp && pnpm dlx shadcn@latest add collapsible -y
```

**3. Update `src/components/sidebar/sidebar.tsx`:**

Add SidebarSidekiqs between header and search:

```typescript
// Add import at top
import { SidebarSidekiqs } from "./sidebar-sidekiqs";

// In the expanded sidebar section, add after SidebarHeader:
<>
  <SidebarHeader isCollapsed={isCollapsed} />

  {/* Sidekiqs section */}
  <div className="border-b border-border/50 pb-2">
    <SidebarSidekiqs onSidekiqSelect={onThreadSelect} />
  </div>

  {/* Search */}
  <SidebarSearch
    query={searchQuery}
    onQueryChange={setSearchQuery}
    inputRef={searchInputRef}
  />
  // ... rest unchanged
</>
```

**4. Update `src/components/sidebar/sidebar-collapsed.tsx`:**

Add Sidekiqs icon to the collapsed sidebar icon rail. Find the existing icon buttons and add:

```typescript
// Add import
import { Sparkles } from "lucide-react";

// Add Sidekiqs button after New Chat button, before Settings
<Tooltip>
  <TooltipTrigger asChild>
    <Button variant="ghost" size="icon" asChild>
      <Link href="/sidekiqs">
        <Sparkles className="size-5" />
        <span className="sr-only">Sidekiqs</span>
      </Link>
    </Button>
  </TooltipTrigger>
  <TooltipContent side="right">Sidekiqs</TooltipContent>
</Tooltip>
```
  </action>
  <verify>
1. Start dev server and check sidebar shows Sidekiqs section
2. Collapsed sidebar shows Sidekiqs icon
3. "See all" link navigates to /sidekiqs
4. Click Sidekiq item navigates to /chat?sidekiq=id
  </verify>
  <done>
Sidebar updated with Sidekiqs section showing favorites first, then recent (max 5). Collapsed sidebar has Sidekiqs icon. Section is collapsible with "See all" link when more than 5 Sidekiqs.
  </done>
</task>

</tasks>

<verification>
1. Navigate to /sidekiqs - shows empty state or list
2. Empty state has "Create your first Sidekiq" CTA
3. View toggle switches between grid and list
4. View preference persists after refresh
5. Sidebar shows Sidekiqs section with favorites starred
6. Collapsed sidebar shows Sidekiqs icon
7. Search filters Sidekiqs in list
8. Delete dialog requires typing exact name
</verification>

<success_criteria>
- /sidekiqs page loads and displays user's Sidekiqs
- Grid/list toggle works and persists to localStorage
- Empty state shown when no Sidekiqs exist
- Sidebar shows up to 5 Sidekiqs with favorites first
- Collapsed sidebar has Sidekiqs icon linking to /sidekiqs
- Delete dialog type-to-confirm works correctly
</success_criteria>

<output>
After completion, create `.planning/phases/06-sidekiq-crud/06-03-SUMMARY.md`
</output>
