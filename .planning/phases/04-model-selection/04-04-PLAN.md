---
phase: 04-model-selection
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - sidekiq-webapp/src/components/model-picker/model-picker-trigger.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Clicking the model picker opens a dropdown showing available models"
    - "PopoverTrigger onClick handler flows through to the Button element"
  artifacts:
    - path: "sidekiq-webapp/src/components/model-picker/model-picker-trigger.tsx"
      provides: "Trigger button that forwards all props including onClick"
      contains: "...props"
  key_links:
    - from: "PopoverTrigger (asChild)"
      to: "ModelPickerTrigger"
      via: "props spread"
      pattern: "\\{\\.\\.\\.props\\}"
---

<objective>
Fix the model picker dropdown not opening when clicked.

Purpose: PopoverTrigger with asChild passes onClick to its child component, but ModelPickerTrigger was not forwarding rest props to the underlying Button element, causing the click handler to be discarded.

Output: Working model picker that opens on click.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/04-model-selection/04-UAT.md (gap diagnosis)
@sidekiq-webapp/src/components/model-picker/model-picker-trigger.tsx
@sidekiq-webapp/src/components/model-picker/model-picker.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Forward rest props in ModelPickerTrigger</name>
  <files>sidekiq-webapp/src/components/model-picker/model-picker-trigger.tsx</files>
  <action>
Update the ModelPickerTrigger component to forward all props to the Button element:

1. Change interface to extend React.ComponentPropsWithoutRef<"button">:
   ```typescript
   interface ModelPickerTriggerProps
     extends React.ComponentPropsWithoutRef<"button"> {
     selectedModel: ModelConfig | undefined;
   }
   ```

2. Update the component signature to destructure with rest spread:
   ```typescript
   >(({ selectedModel, disabled, className, ...props }, ref) => {
   ```

3. Spread {...props} on the Button element:
   ```typescript
   <Button
     ref={ref}
     variant="outline"
     size="sm"
     disabled={disabled}
     className={cn(...)}
     {...props}
   >
   ```

This ensures PopoverTrigger's onClick (and any other props) flow through to the actual button element.
  </action>
  <verify>
TypeScript compiles without errors:
```bash
cd sidekiq-webapp && npm run typecheck
```
  </verify>
  <done>ModelPickerTrigger extends ComponentPropsWithoutRef and spreads rest props on Button</done>
</task>

<task type="auto">
  <name>Task 2: Verify model picker opens on click</name>
  <files>N/A (manual verification)</files>
  <action>
Start the dev server and verify the fix works:

1. Run the dev server: `npm run dev` (from sidekiq-webapp)
2. Navigate to the chat page
3. Click the model picker button
4. Confirm the dropdown opens showing available models grouped by provider
  </action>
  <verify>
Start the dev server and test manually:
```bash
cd sidekiq-webapp && npm run dev
```
Then navigate to http://localhost:3000/chat and click the model picker.

The dropdown should open showing:
- Search input at top
- Favorites section (if any)
- Models grouped by provider (OpenAI, Anthropic, Google)
  </verify>
  <done>Model picker dropdown opens when clicked, showing available models grouped by provider</done>
</task>

</tasks>

<verification>
1. `npm run typecheck` passes in sidekiq-webapp
2. Model picker button is clickable
3. Clicking opens the popover with model list
4. Selecting a model closes the popover and updates the display
</verification>

<success_criteria>
- ModelPickerTrigger forwards all props including onClick from PopoverTrigger
- Model picker dropdown opens on click
- All 9 previously skipped UAT tests are now unblocked
</success_criteria>

<output>
After completion, create `.planning/phases/04-model-selection/04-04-SUMMARY.md`
</output>
