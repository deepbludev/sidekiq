---
phase: 05-sidebar-navigation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - sidekiq-webapp/src/components/sidebar/sidebar.tsx
  - sidekiq-webapp/src/components/sidebar/sidebar-header.tsx
  - sidekiq-webapp/src/components/sidebar/sidebar-collapsed.tsx
  - sidekiq-webapp/src/components/sidebar/index.ts
  - sidekiq-webapp/src/app/(dashboard)/chat/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar displays on desktop with collapsible toggle"
    - "When collapsed, sidebar shows icon rail with New Chat, Sidekiqs, Settings icons"
    - "New Chat button is prominently displayed below logo"
    - "Clicking New Chat navigates to /chat"
  artifacts:
    - path: "sidekiq-webapp/src/components/sidebar/sidebar.tsx"
      provides: "Main sidebar container with collapse logic"
      exports: ["Sidebar"]
    - path: "sidekiq-webapp/src/components/sidebar/sidebar-header.tsx"
      provides: "Logo and New Chat button"
      exports: ["SidebarHeader"]
    - path: "sidekiq-webapp/src/components/sidebar/sidebar-collapsed.tsx"
      provides: "Icon rail for collapsed state"
      exports: ["SidebarCollapsed"]
    - path: "sidekiq-webapp/src/app/(dashboard)/chat/layout.tsx"
      provides: "Layout with sidebar integration"
  key_links:
    - from: "sidebar.tsx"
      to: "sidebar-header.tsx"
      via: "component composition"
      pattern: "<SidebarHeader"
    - from: "layout.tsx"
      to: "sidebar.tsx"
      via: "component import"
      pattern: "import.*Sidebar"
---

<objective>
Create the sidebar layout structure with header, collapse behavior, and icon rail for collapsed state.

Purpose: Build the visual container for the sidebar that houses thread list, search, and footer. This is the shell that other components will plug into.
Output: Sidebar component with header, collapsed state UI, and integration into chat layout.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-sidebar-navigation/05-CONTEXT.md
@.planning/phases/05-sidebar-navigation/05-RESEARCH.md
@sidekiq-webapp/src/app/(dashboard)/chat/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SidebarHeader component</name>
  <files>sidekiq-webapp/src/components/sidebar/sidebar-header.tsx</files>
  <action>
Create `sidebar-header.tsx` with:

1. **Props interface:**
```typescript
interface SidebarHeaderProps {
  isCollapsed: boolean;
}
```

2. **Layout:**
   - Logo at top (just text "S" or small icon for now, no app name per CONTEXT.md)
   - New Chat button below logo - prominent placement
   - Use lucide-react icons: `Plus` or `PenSquare` for new chat

3. **New Chat button:**
   - When expanded: Button with icon + "New Chat" text
   - When collapsed: Icon-only button with Tooltip
   - On click: navigate to `/chat` using `useRouter().push('/chat')`
   - Styling: Primary-style button or ghost with accent on hover

4. **Responsive to collapse:**
   - Show full button with text when `!isCollapsed`
   - Show icon-only with tooltip when `isCollapsed`

5. **Styling:**
   - Padding and spacing consistent with sidebar width
   - Vertical stack: logo â†’ new chat button
   - Use Tooltip from @sidekiq/components/ui/tooltip for collapsed state

Add JSDoc for the component.
  </action>
  <verify>TypeScript compiles: `cd sidekiq-webapp && pnpm tsc --noEmit`</verify>
  <done>SidebarHeader renders logo and New Chat button, adapts to collapsed state</done>
</task>

<task type="auto">
  <name>Task 2: Create SidebarCollapsed (icon rail)</name>
  <files>sidekiq-webapp/src/components/sidebar/sidebar-collapsed.tsx</files>
  <action>
Create `sidebar-collapsed.tsx` with:

1. **Purpose:** Icon rail shown when sidebar is collapsed (per CONTEXT.md - like Linear/Notion)

2. **Icons to display:**
   - New Chat (Plus or PenSquare) - navigates to /chat
   - Sidekiqs (Sparkles or Bot) - placeholder for now, no action
   - Settings (Settings icon) - placeholder for now, no action

3. **Layout:**
   - Vertical stack of icon buttons
   - Centered in the collapsed sidebar width
   - Each with Tooltip showing label on hover

4. **Implementation:**
```typescript
interface SidebarCollapsedProps {
  onNewChat: () => void;
}
```

5. **Styling:**
   - Icon buttons with ghost variant
   - Size appropriate for icon rail (~40px touch target)
   - Subtle hover state

6. **Tooltip integration:**
   - Wrap each button with Tooltip
   - Side="right" so tooltip appears to the right

Add JSDoc for the component.
  </action>
  <verify>TypeScript compiles: `cd sidekiq-webapp && pnpm tsc --noEmit`</verify>
  <done>SidebarCollapsed renders icon rail with New Chat, Sidekiqs, Settings icons with tooltips</done>
</task>

<task type="auto">
  <name>Task 3: Create main Sidebar component</name>
  <files>sidekiq-webapp/src/components/sidebar/sidebar.tsx, sidekiq-webapp/src/components/sidebar/index.ts</files>
  <action>
Create `sidebar.tsx` with:

1. **State:**
   - Import useSidebarState from Plan 05-01 (will be available by execution time)
   - Get `isCollapsed`, `toggle` from hook

2. **Layout structure:**
```tsx
<aside className={cn(
  "flex h-full flex-col border-r border-border/50 bg-background transition-all duration-200 ease-out",
  isCollapsed ? "w-16" : "w-72"
)}>
  {isCollapsed ? (
    <SidebarCollapsed onNewChat={handleNewChat} />
  ) : (
    <>
      <SidebarHeader isCollapsed={isCollapsed} />

      {/* Search placeholder - will be added in Plan 05-04 */}
      <div className="px-3 py-2">
        {/* SidebarSearch will go here */}
      </div>

      {/* Thread list placeholder - will be added in Plan 05-03 */}
      <div className="flex-1 overflow-hidden">
        {/* SidebarThreadList will go here */}
      </div>

      {/* Footer placeholder - will be added in Plan 05-05 */}
      <div className="border-t border-border/50 p-3">
        {/* SidebarFooter will go here */}
      </div>
    </>
  )}

  {/* Collapse toggle button - always visible */}
  <button
    onClick={toggle}
    className="absolute ..." // Position appropriately
  >
    {isCollapsed ? <ChevronRight /> : <ChevronLeft />}
  </button>
</aside>
```

3. **Collapse toggle button:**
   - Small button to toggle collapse
   - Position at bottom of sidebar or floating at edge
   - Use ChevronLeft/ChevronRight icons from lucide-react

4. **handleNewChat function:**
   - Use `useRouter().push('/chat')` to navigate

5. **Styling per CONTEXT.md:**
   - Solid background (no glassmorphism blur)
   - Subtle vertical border separating from main content
   - Smooth animations for collapse/expand (200ms ease-out via Tailwind transition)

6. **Dimensions:**
   - Expanded: w-72 (288px, per RESEARCH.md recommendation ~280px)
   - Collapsed: w-16 (64px, per RESEARCH.md recommendation)

7. **Create index.ts barrel export:**
```typescript
export { Sidebar } from "./sidebar";
export { SidebarHeader } from "./sidebar-header";
export { SidebarCollapsed } from "./sidebar-collapsed";
```

Add JSDoc for the component.
  </action>
  <verify>TypeScript compiles: `cd sidekiq-webapp && pnpm tsc --noEmit`</verify>
  <done>Sidebar component renders with collapse/expand, shows header or icon rail based on state</done>
</task>

<task type="auto">
  <name>Task 4: Update chat layout to integrate sidebar</name>
  <files>sidekiq-webapp/src/app/(dashboard)/chat/layout.tsx</files>
  <action>
Update `layout.tsx` to include sidebar:

1. **Import Sidebar:**
```typescript
import { Sidebar } from "@sidekiq/components/sidebar";
```

2. **Update layout structure:**
```tsx
<TooltipProvider>
  <div className="flex h-screen">
    {/* Desktop sidebar - hidden on mobile (mobile drawer in Plan 05-05) */}
    <div className="hidden md:block">
      <Sidebar />
    </div>

    {/* Main content area */}
    <div className="flex flex-1 flex-col">
      {/* Header - now simpler, theme toggle moves to sidebar footer later */}
      <header className="border-border/50 flex h-14 shrink-0 items-center justify-between border-b px-4 md:hidden">
        {/* Mobile: show hamburger menu trigger (added in Plan 05-05) */}
        <span className="text-lg font-semibold">Sidekiq</span>
        <ThemeToggle />
      </header>

      {/* Main content */}
      <main className="flex-1 overflow-hidden">{children}</main>
    </div>
  </div>
</TooltipProvider>
```

3. **Key changes:**
   - Wrap in flex container with sidebar on left
   - Sidebar hidden on mobile (`hidden md:block`) - mobile drawer added later
   - Header simplified: only shows on mobile now (md:hidden)
   - Desktop will have theme toggle in sidebar footer (later)

4. **Keep existing ThemeToggle import and usage for mobile header.**

Add/update JSDoc for the layout.
  </action>
  <verify>
1. TypeScript compiles: `cd sidekiq-webapp && pnpm tsc --noEmit`
2. Lint passes: `pnpm lint`
3. Dev server starts without errors: `pnpm dev` (manual check)
  </verify>
  <done>Layout shows sidebar on desktop, header with hamburger placeholder on mobile</done>
</task>

</tasks>

<verification>
1. All files created with proper TypeScript types
2. No TypeScript errors: `pnpm tsc --noEmit`
3. Lint passes: `pnpm lint`
4. Sidebar visible on desktop when navigating to /chat
5. Collapse toggle works (click shows icon rail)
6. New Chat button navigates to /chat
</verification>

<success_criteria>
- Sidebar component renders on desktop (/chat page)
- Sidebar collapses to icon rail when toggle clicked
- Collapsed state shows New Chat, Sidekiqs, Settings icons with tooltips
- Expanded state shows header with logo and New Chat button
- New Chat button navigates to /chat
- Layout properly splits sidebar and main content
- Mobile shows simplified header (no sidebar yet - that's Plan 05-05)
</success_criteria>

<output>
After completion, create `.planning/phases/05-sidebar-navigation/05-02-SUMMARY.md`
</output>
